<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Rolling FTE Planner Â· Access</title>
<style>
  :root{
    --bg:#f6f8fc; --panel:#fff; --border:#e5e7eb; --muted:#64748b;
    --brand:#18b6a0; --brand2:#12927f; --err:#dc2626; --ok:#16a34a;
  }
  html,body{margin:0;background:var(--bg);font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:980px;margin:40px auto;padding:0 14px}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
  .brand{font-weight:800;letter-spacing:.2px}
  .badge{padding:4px 8px;border:1px solid var(--border);border-radius:999px;background:#fff;font-size:12px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:0 6px 22px rgba(2,6,23,.06)}
  h3{margin:0 0 10px 0}
  .input{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
  .input label{font-size:12px;color:var(--muted)}
  input,button{height:44px;border:1px solid var(--border);border-radius:12px;padding:10px;font-size:14px}
  button{cursor:pointer;background:#fff}
  .btn.primary{background:linear-gradient(180deg,var(--brand),var(--brand2));color:#fff;border:none}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .err{color:var(--err);margin-top:8px;min-height:18px}
  .ok{color:var(--ok)}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">Rolling FTE Planner</div>
    <span class="badge">access build 2025-10-09b</span>
  </header>

  <div class="grid">
    <!-- Sign in -->
    <div class="card">
      <h3>Sign in</h3>
      <div class="input">
        <label>Email</label>
        <input id="loginEmail" type="email" placeholder="you@company.com" autocomplete="username" spellcheck="false">
      </div>
      <div class="input">
        <label>Password</label>
        <input id="loginPass" type="password" placeholder="********" autocomplete="current-password">
      </div>
      <div class="row">
        <button id="btnLogin" class="btn primary">Sign in</button>
        <button id="btnForgot" class="btn">Forgot password</button>
      </div>
      <div id="loginErr" class="err"></div>
    </div>

    <!-- Create account -->
    <div class="card">
      <h3>Create account</h3>
      <div class="input">
        <label>Email</label>
        <input id="createEmail" type="email" placeholder="you@company.com" autocomplete="username" spellcheck="false">
      </div>
      <div class="input">
        <label>Password (min 8)</label>
        <input id="createPass" type="password" minlength="8" placeholder="********" autocomplete="new-password">
      </div>
      <button id="btnCreate" class="btn primary">Create account</button>
      <div id="createErr" class="err"></div>
    </div>
  </div>
</div>

<!-- Firebase Auth (ES modules from CDN) -->
<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js';
  import {
    getAuth, onAuthStateChanged, signInWithEmailAndPassword,
    createUserWithEmailAndPassword, sendPasswordResetEmail
  } from 'https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js';

  // Replace with your own config if needed
  const firebaseConfig = {
    apiKey: "AIzaSyBG9uJSuftXsRqvIxo2NZPRJmsLGro3vbA",
    authDomain: "fte-planner.firebaseapp.com",
    projectId: "fte-planner",
    storageBucket: "fte-planner.firebasestorage.app",
    messagingSenderId: "410936425819",
    appId: "1:410936425819:web:4332c19848bf6ef64c2e7e",
    measurementId: "G-0BZP3LETBE"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const $ = s => document.querySelector(s);

  // Already signed in? Go straight to the app.
  onAuthStateChanged(auth, (user)=>{
    if(user) location.href = 'index.html?v=2025-10-09b';
  });

  // Sign in
  $('#btnLogin').onclick = async ()=>{
    const email = ($('#loginEmail').value||'').trim();
    const pass = $('#loginPass').value||'';
    $('#loginErr').textContent = '';
    try{
      await signInWithEmailAndPassword(auth, email, pass);
      location.href = 'index.html?v=2025-10-09b';
    }catch(e){
      $('#loginErr').textContent = cleanMsg(e.message);
    }
  };

  // Create account
  $('#btnCreate').onclick = async ()=>{
    const email = ($('#createEmail').value||'').trim();
    const pass = $('#createPass').value||'';
    $('#createErr').textContent = '';
    if(!email || pass.length<8){ $('#createErr').textContent='Enter a valid email and 8+ character password.'; return; }
    try{
      await createUserWithEmailAndPassword(auth, email, pass);
      location.href = 'index.html?v=2025-10-09b';
    }catch(e){
      $('#createErr').textContent = cleanMsg(e.message);
    }
  };

  // Forgot password
  $('#btnForgot').onclick = async ()=>{
    const email = ($('#loginEmail').value||'').trim();
    if(!email){ $('#loginErr').textContent='Enter your email first.'; return; }
    try{
      await sendPasswordResetEmail(auth, email);
      $('#loginErr').textContent='Reset email sent.'; $('#loginErr').classList.add('ok');
    }catch(e){
      $('#loginErr').textContent = cleanMsg(e.message); $('#loginErr').classList.remove('ok');
    }
  };

  function cleanMsg(msg){
    // Make Firebase error messages less noisy for end users
    return (msg||'').replace(/^Firebase:\s*/,'').replace(/\(auth\/[^\)]+\)\.?$/,'').trim();
  }
</script>
</body>
</html>
